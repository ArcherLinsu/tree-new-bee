# tree-new-bee
树新蜂

# 通信接口协议  
## 目前支持的连接协议  
TCP    

## 消息格式  

### 消息采用JSON格式

名称均使用小写驼峰格式（camelCase）
例如：   
```json
{ "myId" : "123456" }   
```
建立连接之后，服务器端会立即发送一个JSON消息确认，该消息仅包含有一个随机生成的id字段，该id与此次使用的tcp连接一一对应。  
例如：   
```json
{"id":"b51cbc1d-a694-479b-ac94-68b4c52d1b99"}
```
  
### 客户端 -> 服务器端 发送消息的JSON格式
  
若包含 nickname 字段，则服务器会更新昵称，并将更新后的昵称列表广播给其他连接。   
例如：
```json 
{ "nickname" : "草原猎豹" }   
```
若包含 message 字段，则服务器会将该消息自动广播给其他连接。  
例如：
```json
{ "message" : "大家好，我是草原猎豹，来自厦门，有两个娃。", }
```

### 服务器端 -> 客户端 发送消息的JSON格式

若包含 nicknames 字段，则表示在线用户需要更新。
例如：
```json
{"nicknames":["草原猎豹", "面筋锅"]}
```
若包含 message 字段，则表示有用户发言。  
例如：
```json
{
  "message":"大家好",
  "nickname":"草原猎豹",
  "id":"b51cbc1d-a694-479b-ac94-68b4c52d1b99",
  "time":"2022-03-01 10:29:06 +0800"
}
```
若包含 color 字段，则表示该消息需要用特殊颜色（网页颜色，例如#FF00FF）显示。
例如：
```json
{
  "message":"我是洋红色的草原猎豹",
  "color":"#FF00FF",
  "nickname":"草原猎豹",
  "id":"b51cbc1d-a694-479b-ac94-68b4c52d1b99",
  "time":"2022-03-01 10:30:22 +0800"
}
```
